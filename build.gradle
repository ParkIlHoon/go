plugins {
    id 'java'
    id 'jacoco'
}

allprojects {
    group 'io.go'
    version '0.0.1'
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'jacoco'
    sourceCompatibility = '11'

    ext {
        multipleBuildDir = file(rootProject.buildDir)
        springDocVersion = '1.6.8'
        queryDslVersion = '5.0.0'
    }

    configurations {
        complieOnly {
            extendsFrom annotationProcessor
        }
    }

    repositories {
        mavenCentral()
    }

    test {
        useJUnitPlatform()
        finalizedBy 'jacocoTestReport'
    }

    jacocoTestReport {
        afterEvaluate {
            classDirectories.setFrom(files(classDirectories.files.collect {
                fileTree(dir: it,
                        exclude: [ // jacoco report 생성시 제외시키고자 하는 file에대하여 필터를 걸 수 있다.
                                   '**/*Application*',
                                   '**/QA*', '**/QB*', '**/QC*', '**/QD*', '**/QE*', '**/QF*', '**/QG*', '**/QH*', '**/QI*', '**/QJ*', '**/QK*', '**/QL*', '**/QM*', '**/QN*', '**/QO*', '**/QP*', '**/QQ*', '**/QR*', '**/QS*', '**/QT*', '**/QU*', '**/QV*', '**/QW*', '**/QX*', '**/QY*', '**/QZ*' // exclude classes generated by QueryDSL.
                        ])
            }))
        }

        reports {
            html.required = true
            xml.required = true
        }
    }

    processResources {
        duplicatesStrategy = DuplicatesStrategy.INCLUDE
    }
}

project(':main-application') {
    dependencies {
        implementation project(':routine')
        implementation project(':exercise')
        implementation project(':record')
        implementation project(':statistic')
    }
}
